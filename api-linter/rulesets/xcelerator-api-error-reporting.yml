rules:

  Siemens-API-[300]:
    message: '{{property}} is not using an official response code'
    description: API MUST use official HTTP status codes as intended.
    documentationUrl: https://developer.internal.siemens.com/guidelines/api-guidelines/rest/error.html#errorreportingrule300
    severity: error
    given: $.paths.*.*.responses.*~
    then:
      function: enumeration
      functionOptions:
        values:
          - '100' 
          - '101' 
          - '102' 
          - '103' 
          - '200' 
          - '201' 
          - '202' 
          - '203' 
          - '204' 
          - '205' 
          - '206' 
          - '207' 
          - '208' 
          - '226' 
          - '300' 
          - '301' 
          - '302' 
          - '303' 
          - '304' 
          - '305' 
          - '306' 
          - '307' 
          - '308' 
          - '400' 
          - '401' 
          - '402' 
          - '403' 
          - '404' 
          - '405' 
          - '406' 
          - '407' 
          - '408' 
          - '409' 
          - '410' 
          - '411' 
          - '412' 
          - '413' 
          - '414' 
          - '415' 
          - '416' 
          - '417' 
          - '418' 
          - '421' 
          - '422' 
          - '423' 
          - '424' 
          - '425' 
          - '426' 
          - '427' 
          - '428' 
          - '429' 
          - '430' 
          - '431' 
          - '451' 
          - '500' 
          - '501' 
          - '502' 
          - '503' 
          - '504' 
          - '505' 
          - '506' 
          - '507' 
          - '508' 
          - '509' 
          - '510' 
          - '511' 
          - default

  Siemens-API-[301]:
    message: '{{property}} is not a standardized response code'
    description: SHOULD only use most common HTTP status codes
    documentationUrl: https://developer.internal.siemens.com/guidelines/api-guidelines/rest/error.html#errorreportingrule301
    severity: warn
    given: $.paths.*.*.responses.*~
    then:
      function: enumeration
      functionOptions:
        values:
          - '200'
          - '201'
          - '202'
          - '204'
          - '301'
          - '303'
          - '304'
          - '305'
          - '307'
          - '400'
          - '401'
          - '403'
          - '404'
          - '405'
          - '406'
          - '408'
          - '409'
          - '412'
          - '415'
          - '429'
          - '500'
          - '501'
          - '503'
          - '504'
          - default
  
  Siemens-API-[302]:
    message: '{{property}} is not using most specific HTTP status code for error'
    description: Xcelerator API SHOULD use the most specific HTTP status code when returning information about the request processing state or reported error situations
    documentationUrl: https://developer.internal.siemens.com/guidelines/api-guidelines/rest/error.html#errorreportingrule302
    severity: warn
    given: $.components.examples..*.errors.*.status
    then:
      function: enumeration
      functionOptions:
        values:
          - '400'
          - '401'
          - '403'
          - '404'
          - '405'
          - '406'
          - '408'
          - '409'
          - '412'
          - '415'
          - '429'
          - '500'
          - '501'
          - '503'
  
  Siemens-API-[305]-1:
    message: Error object SHOULD be represented according to the defined structure fields
    description: Error object SHOULD be represented according to the defined structure fields
    documentationUrl: https://developer.internal.siemens.com/guidelines/api-guidelines/rest/error.html#errorreportingrule305
    severity: warn
    given: $.components.schemas.Errors..*..errors.*.properties.*~
    then:
      function: enumeration
      functionOptions:
        values:
          - 'id'
          - 'code'
          - 'status'
          - 'title'
          - 'detail'
          - 'links'
          - 'correlationId'
          - 'source'
  
  Siemens-API-[305]-2:
    message: 'The error links resource object MAY contain the members: about, type'
    description: 'The error links resource object MAY contain the members: about, type'
    documentationUrl: https://developer.internal.siemens.com/guidelines/api-guidelines/rest/error.html#errorreportingrule305
    severity: info
    given: $.components.schemas.Errors..*..links.properties.*~
    then:
      function: enumeration
      functionOptions:
        values:
          - 'about'
          - 'type'
  
  Siemens-API-[305]-3:
    message: 'The source object SHOULD include one of the members or be omitted: pointer, parameter, header'
    description: 'The source object SHOULD include one of the members or be omitted: pointer, parameter, header'
    documentationUrl: https://developer.internal.siemens.com/guidelines/api-guidelines/rest/error.html#errorreportingrule305
    severity: warn
    given: $.components.schemas.Errors..*..source.properties.*~
    then:
      function: enumeration
      functionOptions:
        values:
          - 'pointer'
          - 'parameter'
          - 'header'

